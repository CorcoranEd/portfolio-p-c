<link rel="import" href="../../bower_components/polymer/polymer.html">
<dom-module id="project-list">
	<template>
		<style include="shared-styles">
		:root {
			text-align: center;
		}

		.project-header {
			text-align: center;
			margin-top: 6.25em;
			margin-bottom: var(--spacing-unit);
		}

		.project-title {
			letter-spacing: -1px;
			line-height: 1;
		}

		.list {
			display: flex;
			flex-flow: row wrap;
			margin: 6.25em 0;
		}

		.list-item {
			width: 50%;
		}

		.list-item-content {
			padding: 0 calc(var(--spacing-unit) / 2);
		}

		.list-item:nth-child(2n+0) {
			margin-bottom: var(--spacing-unit);
		}

		.list-item:nth-last-child(2) {
			margin-bottom: 0 !important;
		}

		@media (max-width: 600px) {
			ul {
				margin: 4em 0;
			}

			li {
				flex: 1 100%;
				margin-left: 0 !important;
				margin-bottom: var(--spacing-unit);
			}
		}
		</style>

		<div class="wrapper">
			<header class="project-header spacing">
				<h1 class="project-title">Projects</h1>
			</header>
			<div class="list">
				<template is="dom-repeat" items="[[projects.items]]">
					<div class="list-item">
						<div class="list-item-content">
							<a class="project-link" href="/[[item.fields.slug]]">
								<iron-image class="project-hero-image" preload fade src="[[_fetchImageUrl(item.fields.heroImage.sys.id)]]"></iron-image>
								<div>[[item.fields.title]]</div>
							</a>
						</div>
					</div>
				</template>
			</div>
		</div>
	</template>
	<script>
	Polymer({

		is: 'project-list',

		properties: {
			projects: Object
		},

		_fetchImageUrl: function(id) {
			console.log('this on listing page: ', id, this);

			var length = this.projects.includes.Asset.length;

			for (var i = 0; i < length; i++) {
				if (this.projects.includes.Asset[i].sys.id === id) {
					return this.projects.includes.Asset[i].fields.file.url;
				}
			}
		}

	});
	</script>
</dom-module>
